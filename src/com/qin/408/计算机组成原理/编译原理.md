## 编译原理

### 绪论
编译：将高级语言翻译成汇编语言或机器语言的过程  
高级语言   -编译->    汇编语言   -汇编->   机器语言  

可重定位：在内存中存放的起始位置不是固定的  
加载器：膝盖可重定位地址；将修改后的指令和数据放到内存中的适当位置
起始位置 + 相对地址 = 绝对地址  
链接器：将多个可重定位的机器代码文件连接到一起  

#### 编译器的结构  
词法分析  
语法分析(词法单元流)  
语义分析(语法树)  
中间代码生成  
机器无关代码优化  
目标代码生成  
机器相关代码优化  

#### 词法分析
扫描源程序的字符，识别出各个单词，确定**单词的类型**，转换成统一的词法单元(token<种别码，属性值>)  

|  | 单词类型 | 种别 | 种别码 |
| --- | --- | --- | --- |
| 1 | 关键字 | if else... | 一词一码 |
| 2 | 标识符 | 变量名，数组名... | 多词一码 |
|3|常量|整形、浮点型、字符型、布尔型|一型一码|
|4|运算符|算术 逻辑 关系| 一词一码|
|5|界限符|{}();|一词一码|

#### 语法分析
从词法分析器输出的token序列中识别出各类短语，构造语法分析树

```
变量声明语句
int a = 10;
<D> = <T><IDS>;
<T> -> int | real | char | bool
<IDS> -> id | <IDS>,ID
```

#### 语义分析
声明语句 可执行语句  
* 识别标识符的属性信息  
  * 种属kind(简单变量 符合变量(数组))
  * 类型type(整形、字符型、布尔型)
  * 存储位置长度addr
  * 作用域
  * 参数和返回值
* 语义检查
  * 变量未声明就使用
  * 重复声明
  * 运算类型不匹配
  * 数组下标不是整数
  * 函数调用参数类型个数不匹配
  * 函数返回类型有误
生成符号表(用来存放标识符的属性信息的数据结构)  
每一个标识符对应符号表一条记录  
(存放标识符起始位置 + 长度)

#### 中间代码生成
* 三地址码
  每个指令最多三个操作数
  * 四元式
* 语法树

#### 目标代码生成
为程序中使用的变量合理分配寄存器

#### 代码优化
等价程序变换
* 机器无关优化(中间代码)
* 机器相关优化(目标代码)

p7


